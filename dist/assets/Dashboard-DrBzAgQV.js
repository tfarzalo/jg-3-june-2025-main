const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Jobs-BDmeFfNv.js","assets/index-nRXVoRx_.js","assets/react-vendor--AdGielI.js","assets/supabase-Dq0wjmmz.js","assets/index-Bb5O2NJ5.css","assets/useJobFetch-ep4kg6_o.js","assets/utils-DsqaXd9R.js","assets/pdf-TGvrJ6T9.js","assets/ui-a3QeRpHh.js","assets/useSessionValidation-Dpzv_eLL.js","assets/JobRequests-DqEGPHlU.js","assets/WorkOrders-CVA0KZMb.js","assets/Invoicing-C8KmSYwR.js","assets/Completed-D_RVVo0L.js","assets/CancelledJobs-BjLmXNcK.js","assets/Archives-CAStDcZD.js","assets/JobDetails-Bg3YzdwA.js","assets/dateUtils-BelUzJwD.js","assets/formatUtils-fTiefMj9.js","assets/AppContent-Dvvh2h3j.js","assets/PropertyMap-g0Uczq7S.js","assets/leaflet-DrIUZV5B.js","assets/leaflet-Dgihpmma.css","assets/ImageGallery-Daqwq708.js","assets/Properties-C_fBInSo.js","assets/supabaseErrorHandler-1QEbvNQf.js","assets/PropertyDetails-CnL1jjbn.js","assets/PropertyForm-B-a_C1fk.js","assets/useLeafletMap-CRYQb5e4.js","assets/PropertyEditForm-knXh7yDm.js","assets/PropertyGroups-BTYXn1GY.js","assets/PropertyGroupDetails-DBANIIEh.js","assets/PropertyGroupForm-6MjDuXq5.js","assets/PropertyGroupArchives-DNEZ-6TX.js","assets/PropertyArchives-Dt1DH1PE.js","assets/FileManager-Cbu_yuWG.js","assets/FileManager-DRT7dAKZ.css","assets/FileUpload-BL7SCv_p.js","assets/Calendar-CMOg8zoZ.js","assets/Activity-BxjqOuoJ.js","assets/Users-HgoTATKV.js","assets/AppSettings-DA1FAGsZ.js","assets/UserProfile-BkOF2MHu.js","assets/SubScheduler-Om-KhleU.js","assets/JobRequestForm-dhntaJAk.js","assets/JobEditForm-BqdG3JOi.js","assets/WorkOrderForm-DW5N3ujR.js","assets/WorkOrderEditForm-DDJN3MXb.js","assets/BillingDetailsForm-VptSc7No.js","assets/NewWorkOrder-x0yinFaI.js","assets/TempWorkOrderForm-C8Jkvy9Q.js","assets/WorkingOrdersBilling-DjFJWDmY.js"])))=>i.map(i=>d[i]);
import{_ as e}from"./supabase-Dq0wjmmz.js";import{j as t,s}from"./index-nRXVoRx_.js";import{L as r,r as a,j as l,h as n}from"./react-vendor--AdGielI.js";import{u as o}from"./AppContent-Dvvh2h3j.js";import{g as d,p as i,e as c,F as m,r as h,D as p,f as _,P as x,l as b,x as j}from"./ui-a3QeRpHh.js";import{a as u}from"./utils-DsqaXd9R.js";function y({icon:e,label:s,value:r,trend:a,color:l="blue"}){const n=(()=>{if(l&&l.startsWith("#")){return{style:{backgroundColor:((e,t)=>`rgba(${parseInt(e.slice(1,3),16)}, ${parseInt(e.slice(3,5),16)}, ${parseInt(e.slice(5,7),16)}, ${Math.max(0,Math.min(1,t))})`)(l,.1)}}}return{className:{blue:"bg-blue-500/10 dark:bg-blue-500/10",orange:"bg-orange-500/10 dark:bg-orange-500/10",purple:"bg-purple-500/10 dark:bg-purple-500/10",emerald:"bg-emerald-500/10 dark:bg-emerald-500/10",red:"bg-red-500/10 dark:bg-red-500/10"}[l]||"bg-blue-500/10 dark:bg-blue-500/10"}})();return t.jsxs("div",{className:"bg-white dark:bg-[#1E293B] rounded-xl p-6 shadow-lg transition-all duration-200 hover:shadow-xl",children:[t.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center mb-4 ${n.className||""}`,style:n.style,children:t.jsx(e,{className:`h-6 w-6 ${(()=>{if("Pending Work Orders"===s)return"text-[#DAA520]";if(l&&l.startsWith("#"))return`text-[${l}]`;switch(l){case"blue":default:return"text-blue-600 dark:text-blue-400";case"orange":return"text-orange-600 dark:text-orange-400";case"purple":return"text-purple-600 dark:text-purple-400";case"emerald":return"text-emerald-600 dark:text-emerald-400";case"red":return"text-red-600 dark:text-red-400"}})()}`})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-1",children:s}),t.jsx("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white mb-2",children:r}),t.jsxs("p",{className:"text-sm "+(a.isPositive?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:[a.isPositive?"+":"-",a.value,"% vs previous 30 days"]})]})]})}function g({title:e,children:s,viewAllLink:a,actionButton:l,titleColor:n="text-gray-900 dark:text-white",className:o="",phaseColor:d}){return t.jsxs("div",{className:`bg-white dark:bg-surface-dark rounded-xl overflow-hidden shadow-lg ${o}`,children:[d&&t.jsx("div",{className:"h-1 w-full",style:{backgroundColor:d}}),t.jsxs("div",{className:"px-6 py-4 flex items-center justify-between border-b border-gray-200 dark:border-border-dark",children:[t.jsx("h2",{className:`font-medium ${n}`,children:e}),t.jsxs("div",{className:"flex items-center space-x-4",children:[l,a&&t.jsx(r,{to:a,className:"text-sm text-gray-500 hover:text-gray-700 dark:text-text-muted-dark dark:hover:text-text-base-dark transition-colors",children:"View All"})]})]}),t.jsx("div",{className:"p-6",children:s})]})}const f=({open:e,onClose:s,jobs:a})=>{const{role:l}=o(),n=a;if(!e||"admin"!==l&&"jg_management"!==l)return null;return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:t.jsxs("div",{className:"bg-white dark:bg-[#1E293B] rounded-lg shadow-xl max-w-4xl w-full max-h-[80vh] overflow-hidden",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 bg-blue-600 text-white",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(d,{className:"h-6 w-6"}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-semibold",children:"Today's Agenda"}),t.jsx("p",{className:"text-blue-100 text-sm",children:(new Date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]})]}),t.jsx("button",{onClick:s,className:"text-white hover:text-blue-200 transition-colors",children:t.jsx(i,{className:"h-6 w-6"})})]}),t.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(80vh-140px)]",children:0===n.length?t.jsxs("div",{className:"text-center py-12",children:[t.jsx(d,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No Jobs Scheduled for Today"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"There are no jobs scheduled for today. Check back tomorrow or view all jobs."})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-700 dark:text-gray-300 mb-4",children:[t.jsxs("span",{className:"text-lg font-medium text-gray-900 dark:text-white",children:["Today's Jobs: ",n.length," Total"]}),t.jsxs("div",{className:"flex space-x-6",children:[t.jsxs("span",{className:"text-blue-500 font-medium",children:["Paint: ",n.filter((e=>{const t=Array.isArray(e.job_type)&&e.job_type.length>0?e.job_type[0]:e.job_type;return"Paint"===t?.job_type_label})).length]}),t.jsxs("span",{className:"text-orange-500 font-medium",children:["Callback: ",n.filter((e=>{const t=Array.isArray(e.job_type)&&e.job_type.length>0?e.job_type[0]:e.job_type;return"Callback"===t?.job_type_label})).length]}),t.jsxs("span",{className:"text-red-500 font-medium",children:["Repair: ",n.filter((e=>{const t=Array.isArray(e.job_type)&&e.job_type.length>0?e.job_type[0]:e.job_type;return"Repair"===t?.job_type_label})).length]})]})]}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Here's an overview of all jobs scheduled for today across all phases."})]}),t.jsx("div",{className:"space-y-2",children:n.map((e=>{const s=Array.isArray(e.job_phase)&&e.job_phase.length>0?e.job_phase[0]:e.job_phase,a=Array.isArray(e.property)&&e.property.length>0?e.property[0]:e.property,l=Array.isArray(e.job_type)&&e.job_type.length>0?e.job_type[0]:e.job_type;return t.jsx(r,{to:`/dashboard/jobs/${e.id}`,className:"block",children:t.jsx("div",{className:"rounded-lg p-3 border border-gray-200 dark:border-gray-700 hover:shadow-md transition-all duration-200",style:{backgroundColor:s?.color_dark_mode?`${s.color_dark_mode}1A`:"rgba(128, 128, 128, 0.1)"},children:t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("h4",{className:"text-base font-medium text-gray-900 dark:text-white",children:[a?.property_name||"Unknown Property",t.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400 ml-2 font-normal",children:["Unit ",e.unit_number]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-xs px-2 py-1 rounded-full font-medium bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300",children:l?.job_type_label||"Unknown Type"}),t.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium text-white",style:{backgroundColor:s?.color_dark_mode||"#6B7280"},children:s?.job_phase_label||"Unknown"})]})]}),t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[t.jsx("span",{className:"font-medium",children:"WO:"})," ",(n=e.work_order_num,`WO-${String(n).padStart(6,"0")}`)]}),t.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[t.jsx("span",{className:"font-medium",children:"Assigned:"})," ",e.assigned_to?Array.isArray(e.assigned_to)?e.assigned_to.length>0&&e.assigned_to[0]?.full_name?e.assigned_to[0].full_name:"Unassigned":"object"==typeof e.assigned_to&&"full_name"in e.assigned_to&&e.assigned_to.full_name||"Unassigned":"Unassigned"]})]}),e.total_billing_amount&&e.total_billing_amount>0?t.jsxs("span",{className:"text-sm font-semibold text-green-600 dark:text-green-400",children:["$",e.total_billing_amount.toFixed(2)]}):null]})]})})})},e.id);var n}))})]})}),t.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-[#0F172A]",children:[t.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"This modal shows once per day for admin and JG management users"}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx(r,{to:"/dashboard/calendar",className:"px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 transition-colors",children:"View Calendar"}),t.jsx("button",{onClick:s,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-colors",children:"Close"})]})]})]})})};function N(){const[e,l]=a.useState(!1),[n,o]=a.useState(!0),[d,i]=a.useState([]),[N,k]=a.useState([]),[v,w]=a.useState({}),{jobRequests:A,workOrders:E,invoicingJobs:P,todaysJobs:D}=function(){const[e,t]=a.useState([]),[r,l]=a.useState([]),[n,o]=a.useState([]),[d,i]=a.useState([]),[c,m]=a.useState(!0),[h,p]=a.useState(null),[_,x]=a.useState({}),b=a.useRef({}),j=a.useRef(!0),y=a.useRef(0),g=a.useCallback((async()=>{if(!j.current)return;const e=Date.now();if(!(e-y.current<5e3)){y.current=e;try{m(!0),p(null);let{data:e,error:r}=await s.from("job_phases").select("id, job_phase_label");if(r){if("401"!==r.code&&!r.message?.includes("401"))throw r;{await new Promise((e=>setTimeout(e,1e3)));const t=await s.from("job_phases").select("id, job_phase_label");if(t.error)throw r;e=t.data}}if(!e)throw new Error("No phases data received");const a=e.reduce(((e,t)=>({...e,[t.job_phase_label]:t.id})),{});x(a),b.current=a;const n=new Date,d=u(n,"America/New_York","yyyy-MM-dd'T'00:00:00XXX"),c=u(n,"America/New_York","yyyy-MM-dd'T'23:59:59XXX"),[h,_,y,g,f]=await Promise.all([s.from("jobs").select("\n            id,\n            work_order_num,\n            unit_number,\n            scheduled_date,\n            created_at,\n            updated_at,\n            total_billing_amount,\n            property:properties (\n              property_name\n            ),\n            job_phase:current_phase_id (\n              job_phase_label,\n              color_dark_mode\n            ),\n            job_type:job_types (\n              job_type_label\n            ),\n            assigned_to:profiles (\n              full_name\n            )\n          ").eq("current_phase_id",a["Job Request"]).neq("current_phase_id",a.Cancelled||"never-match").order("created_at",{ascending:!1}).limit(4),s.from("jobs").select("\n            id,\n            work_order_num,\n            unit_number,\n            scheduled_date,\n            created_at,\n            updated_at,\n            total_billing_amount,\n            property:properties (\n              property_name\n            ),\n            job_phase:current_phase_id (\n              job_phase_label,\n              color_dark_mode\n            ),\n            job_type:job_types (\n              job_type_label\n            ),\n            assigned_to:profiles (\n              full_name\n            )\n          ").eq("current_phase_id",a["Work Order"]).neq("current_phase_id",a.Cancelled||"never-match").order("updated_at",{ascending:!1}).limit(4),s.from("jobs").select("\n            id,\n            work_order_num,\n            unit_number,\n            scheduled_date,\n            created_at,\n            updated_at,\n            total_billing_amount,\n            property:properties (\n              property_name\n            ),\n            job_phase:current_phase_id (\n              job_phase_label,\n              color_dark_mode\n            ),\n            job_type:job_types (\n              job_type_label\n            ),\n            assigned_to:profiles (\n              full_name\n            )\n          ").eq("current_phase_id",a["Pending Work Order"]).neq("current_phase_id",a.Cancelled||"never-match").order("updated_at",{ascending:!1}).limit(4),s.from("jobs").select("\n            id,\n            work_order_num,\n            unit_number,\n            scheduled_date,\n            created_at,\n            updated_at,\n            total_billing_amount,\n            property:properties (\n              property_name\n            ),\n            job_phase:current_phase_id (\n              job_phase_label,\n              color_dark_mode\n            ),\n            job_type:job_types (\n              job_type_label\n            ),\n            assigned_to:profiles (\n              full_name\n            )\n          ").eq("current_phase_id",a.Invoicing||a.Invoice||a.Billing).neq("current_phase_id",a.Cancelled||"never-match").order("updated_at",{ascending:!1}).limit(4),s.from("jobs").select("\n            id,\n            work_order_num,\n            unit_number,\n            scheduled_date,\n            created_at,\n            updated_at,\n            total_billing_amount,\n            property:properties (\n              property_name\n            ),\n            job_phase:current_phase_id (\n              job_phase_label,\n              color_dark_mode\n            ),\n            job_type:job_types (\n              job_type_label\n            ),\n            assigned_to:profiles (\n              full_name\n            )\n          ").in("current_phase_id",[a["Job Request"],a["Work Order"],a["Pending Work Order"]].filter(Boolean)).not("current_phase_id","eq",a.Cancelled||"never-match").gte("scheduled_date",d).lte("scheduled_date",c).order("scheduled_date",{ascending:!0})]);if(h.error)throw h.error;if(_.error)throw _.error;if(y.error)throw y.error;if(g.error)throw g.error;if(f.error)throw f.error;if(j.current){t(h.data||[]);const e=[..._.data||[],...y.data||[]].sort(((e,t)=>new Date(t.updated_at).getTime()-new Date(e.updated_at).getTime())).slice(0,4);l(e),o(g.data||[]),i(f.data||[]),p(null)}}catch(r){j.current&&p(r instanceof Error?r.message:"Failed to fetch jobs")}finally{j.current&&m(!1)}}}),[]);return a.useEffect((()=>{j.current=!0,g();let e=null;const t=()=>{e&&clearTimeout(e),e=setTimeout((()=>{j.current&&g()}),1e3)},r=s.channel("jobs-changes").on("postgres_changes",{event:"*",schema:"public",table:"jobs"},t).subscribe(),a=s.channel("phase-changes").on("postgres_changes",{event:"INSERT",schema:"public",table:"job_phase_changes"},t).subscribe();return()=>{j.current=!1,e&&clearTimeout(e),r.unsubscribe(),a.unsubscribe()}}),[g]),{jobRequests:e,workOrders:r,invoicingJobs:n,todaysJobs:d,loading:c,error:h,refreshJobs:g}}();a.useEffect((()=>{(async()=>{try{o(!0);const[e,t,r]=await Promise.all([s.from("jobs").select("\n              id,\n              work_order_num,\n              unit_number,\n              scheduled_date,\n              property:properties(property_name),\n              job_phase:current_phase_id(job_phase_label, color_dark_mode),\n              assigned_to:profiles(full_name),\n              job_type:job_types(job_type_label),\n              total_billing_amount\n            ").order("created_at",{ascending:!1}),s.from("properties").select("*").eq("is_archived",!1).order("property_name"),s.from("job_phases").select("id, job_phase_label, color_dark_mode")]);if(e.error)throw e.error;if(t.error)throw t.error;if(r.error)throw r.error;k(e.data||[]);const a=(r.data||[]).reduce(((e,t)=>(e[t.job_phase_label]=t.color_dark_mode,e)),{});w(a),await O()}catch(e){}finally{o(!1)}})();const e=s.channel("dashboard-jobs").on("postgres_changes",{event:"INSERT",schema:"public",table:"jobs"},(async e=>{const{data:t,error:r}=await s.from("jobs").select("\n              id,\n              work_order_num,\n              unit_number,\n              scheduled_date,\n              property:properties(property_name),\n              job_phase:current_phase_id(job_phase_label, color_dark_mode),\n              assigned_to:profiles(full_name),\n              job_type:job_types(job_type_label),\n              total_billing_amount\n            ").eq("id",e.new.id).eq("is_archived",!1).eq("is_deleted",!1).single();!r&&t&&k((e=>[t,...e]))})).on("postgres_changes",{event:"UPDATE",schema:"public",table:"jobs"},(async e=>{const{data:t,error:r}=await s.from("jobs").select("\n              id,\n              work_order_num,\n              unit_number,\n              scheduled_date,\n              property:properties(property_name),\n              job_phase:current_phase_id(job_phase_label, color_dark_mode),\n              assigned_to:profiles(full_name),\n              job_type:job_types(job_type_label),\n              total_billing_amount\n            ").eq("id",e.new.id).eq("is_archived",!1).eq("is_deleted",!1).single();!r&&t?k((e=>e.map((e=>e.id===t.id?t:e)))):!r&&t||k((t=>t.filter((t=>t.id!==e.new.id))))})).on("postgres_changes",{event:"DELETE",schema:"public",table:"jobs"},(e=>{k((t=>t.filter((t=>t.id!==e.old.id))))})).subscribe(),t=s.channel("dashboard-activity").on("postgres_changes",{event:"INSERT",schema:"public",table:"job_phase_changes"},(()=>{O()})).subscribe();return()=>{e.unsubscribe(),t.unsubscribe()}}),[]);const O=async()=>{try{const{data:e,error:t}=await s.from("job_phase_changes").select("\n          id,\n          job_id,\n          changed_by,\n          from_phase_id,\n          to_phase_id,\n          change_reason,\n          changed_at\n        ").order("changed_at",{ascending:!1}).limit(4);if(t)throw t;if(!e||0===e.length)return void i([]);const r=e.map((e=>e.from_phase_id)).filter(Boolean),a=e.map((e=>e.to_phase_id)),l=[...new Set([...r,...a])],n=e.map((e=>e.job_id)),o=e.map((e=>e.changed_by)),{data:d,error:c}=await s.from("job_phases").select("id, job_phase_label, color_dark_mode").in("id",l);if(c)throw c;const{data:m,error:h}=await s.from("jobs").select("\n          id,\n          work_order_num,\n          unit_number,\n          property:properties(property_name)\n        ").in("id",n);if(h)throw h;const{data:p,error:_}=await s.from("profiles").select("id, full_name").in("id",o);if(_)throw _;const x=new Map(d?.map((e=>[e.id,e]))||[]),b=new Map(m?.map((e=>[e.id,e]))||[]),j=new Map(p?.map((e=>[e.id,e]))||[]),u=e.map((e=>{const t=b.get(e.job_id),s=e.from_phase_id?x.get(e.from_phase_id):null,r=x.get(e.to_phase_id),a=j.get(e.changed_by);return{id:e.id,job_id:e.job_id,changed_by:e.changed_by,from_phase_id:e.from_phase_id,to_phase_id:e.to_phase_id,change_reason:e.change_reason,changed_at:e.changed_at,from_phase_label:s?.job_phase_label||null,from_phase_color:s?.color_dark_mode||null,to_phase_label:r?.job_phase_label||"",to_phase_color:r?.color_dark_mode||"",job_work_order_num:t?.work_order_num||0,job_unit_number:t?.unit_number||"",property_name:t?.property?.property_name||"",user_full_name:a?.full_name||null}}));i(u)}catch(e){}},T=e=>`WO-${String(e).padStart(6,"0")}`,I=e=>{const t=new Date(e),s=new Date,r=Math.floor((s.getTime()-t.getTime())/1e3);if(r<60)return"just now";if(r<3600){const e=Math.floor(r/60);return`${e} minute${e>1?"s":""} ago`}if(r<86400){const e=Math.floor(r/3600);return`${e} hour${e>1?"s":""} ago`}if(r<604800){const e=Math.floor(r/86400);return`${e} day${e>1?"s":""} ago`}return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},R=D.slice(0,4),C=D||[],L=e=>{const t=Array.isArray(e.job_phase)?e.job_phase[0]:e.job_phase;return t?.color_dark_mode||"#6B7280"},S=e=>{const t=Array.isArray(e.property)?e.property[0]:e.property;return t?.property_name||"Unknown Property"},$=e=>{const t=Array.isArray(e.assigned_to)?e.assigned_to[0]:e.assigned_to;return t?.full_name||"Unassigned"},V=e=>{const t=Array.isArray(e.job_type)?e.job_type[0]:e.job_type;return t?.job_type_label||"Unknown Type"},q=N.filter((e=>"Completed"===e.job_phase?.job_phase_label)).slice(0,8),z=[{icon:c,label:"Job Requests",value:N.filter((e=>"Job Request"===e.job_phase?.job_phase_label)).length.toString(),trend:{value:12,isPositive:!0},color:"blue"},{icon:m,label:"Work Orders",value:N.filter((e=>"Work Order"===e.job_phase?.job_phase_label)).length.toString(),trend:{value:15,isPositive:!0},color:"orange"},{icon:h,label:"Pending Work Orders",value:N.filter((e=>"Pending Work Order"===e.job_phase?.job_phase_label)).length.toString(),trend:{value:8,isPositive:!0},color:"yellow"},{icon:p,label:"Invoicing",value:N.filter((e=>"Invoicing"===e.job_phase?.job_phase_label)).length.toString(),trend:{value:3,isPositive:!1},color:"green"},{icon:_,label:"Completed",value:N.filter((e=>"Completed"===e.job_phase?.job_phase_label)).length.toString(),trend:{value:5,isPositive:!0},color:"purple"}];return n?t.jsx("div",{className:"flex items-center justify-center h-full",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):t.jsxs("div",{className:"p-6 bg-background dark:bg-background-dark min-h-screen",children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-6 mb-8",children:z.map(((e,s)=>t.jsx(r,{to:"Job Requests"===e.label?"/dashboard/jobs/job-requests":"Work Orders"===e.label?"/dashboard/jobs/work-orders":e.label.includes("Jobs")?"/dashboard/jobs":`/dashboard/jobs/${e.label.toLowerCase().replace(" ","-")}`,className:"block",children:t.jsx(y,{icon:e.icon,label:e.label,value:e.value,trend:e.trend,color:e.color})},s)))}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[t.jsx(g,{title:"Job Requests",viewAllLink:"/dashboard/jobs/requests",actionButton:t.jsxs(r,{to:"/dashboard/jobs/new",className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1.5 rounded-lg text-sm flex items-center transition-colors",children:[t.jsx(x,{className:"h-4 w-4 mr-1"}),"Job Request"]}),titleColor:"text-gray-900 dark:text-white",phaseColor:v["Job Request"]||"#3B82F6",className:"min-h-[400px]",children:t.jsx("div",{className:"space-y-4 max-h-[300px] overflow-y-auto",children:0===A.length?t.jsx("div",{className:"text-center py-8 text-gray-500",children:"No job requests found"}):t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase",children:[t.jsx("th",{className:"pb-2",children:"Property"}),t.jsx("th",{className:"pb-2",children:"Unit #"}),t.jsx("th",{className:"pb-2",children:"Work Date"})]})}),t.jsx("tbody",{className:"text-gray-700 dark:text-gray-300 text-sm",children:A.slice(0,8).map((e=>t.jsxs("tr",{className:"cursor-pointer hover:bg-gray-50/50 dark:hover:bg-[#1E293B]/30 transition-colors",children:[t.jsx("td",{className:"py-2",children:t.jsx(r,{to:`/dashboard/jobs/${e.id}`,className:"block",children:S(e)})}),t.jsx("td",{className:"py-2",children:t.jsx(r,{to:`/dashboard/jobs/${e.id}`,className:"block",children:e.unit_number||"N/A"})}),t.jsx("td",{className:"py-2",children:t.jsx(r,{to:`/dashboard/jobs/${e.id}`,className:"block",children:new Date(e.scheduled_date).toLocaleDateString()})})]},e.id)))})]})})}),t.jsx(g,{title:"Work Orders",viewAllLink:"/dashboard/jobs/work-orders",titleColor:"text-gray-900 dark:text-white",className:"min-h-[400px]",phaseColor:v["Work Order"]||"#F97316",children:t.jsx("div",{className:"space-y-4 max-h-[300px] overflow-y-auto",children:0===E.length?t.jsx("div",{className:"text-center py-8 text-gray-500",children:"No work orders found"}):t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase",children:[t.jsx("th",{className:"pb-2",children:"WO#"}),t.jsx("th",{className:"pb-2",children:"Property"}),t.jsx("th",{className:"pb-2",children:"Unit #"}),t.jsx("th",{className:"pb-2",children:"Type"})]})}),t.jsx("tbody",{className:"text-gray-700 dark:text-gray-300 text-sm",children:E.slice(0,8).map((e=>t.jsxs("tr",{className:"cursor-pointer hover:bg-gray-50/50 dark:hover:bg-[#1E293B]/30 transition-colors",children:[t.jsx("td",{className:"py-2",children:t.jsxs(r,{to:`/dashboard/jobs/${e.id}`,className:"flex items-center",children:[t.jsx("span",{className:"w-2 h-2 rounded-full mr-2 flex-shrink-0",style:{backgroundColor:L(e)}}),T(e.work_order_num)]})}),t.jsx("td",{className:"py-2",children:t.jsx(r,{to:`/dashboard/jobs/${e.id}`,className:"block",children:S(e)})}),t.jsx("td",{className:"py-2",children:t.jsx(r,{to:`/dashboard/jobs/${e.id}`,className:"block",children:e.unit_number||"N/A"})}),t.jsx("td",{className:"py-2",children:t.jsx(r,{to:`/dashboard/jobs/${e.id}`,className:"block",children:V(e)})})]},e.id)))})]})})}),t.jsxs(g,{title:"Today's Agenda",viewAllLink:"/dashboard/calendar",titleColor:"text-gray-900 dark:text-white",className:"min-h-[400px]",children:[t.jsx("div",{className:"mb-4 pb-3 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-600 dark:text-gray-400",children:[t.jsxs("div",{className:"flex space-x-4",children:[t.jsxs("span",{className:"text-blue-500 font-medium",children:["Paint: ",R.filter((e=>"Paint"===V(e))).length]}),t.jsxs("span",{className:"text-orange-500 font-medium",children:["Callback: ",R.filter((e=>"Callback"===V(e))).length]}),t.jsxs("span",{className:"text-red-500 font-medium",children:["Repair: ",R.filter((e=>"Repair"===V(e))).length]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("span",{className:"text-gray-500",children:["Total: ",R.length]}),C.length>4&&t.jsx("button",{onClick:()=>l(!0),className:"text-blue-500 hover:text-blue-700 font-medium",children:"View Calendar"})]})]})}),t.jsx("div",{className:"space-y-4 max-h-[300px] overflow-y-auto",children:0===R.length?t.jsx("div",{className:"text-center py-8 text-gray-500",children:"No jobs scheduled for today"}):t.jsxs("div",{className:"max-h-64 overflow-y-auto space-y-2 flex-1 pr-2",children:[R.map((e=>t.jsx(r,{to:`/dashboard/jobs/${e.id}`,className:"block",children:t.jsx("div",{className:"rounded-lg p-2.5",style:{backgroundColor:`${L(e)}1A`},children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsxs("h4",{className:"text-sm font-medium text-gray-900 dark:text-white flex items-center",children:[t.jsx("span",{className:"w-2 h-2 rounded-full mr-2 flex-shrink-0",style:{backgroundColor:L(e)}}),S(e),t.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-400 ml-2",children:["Unit ",e.unit_number]})]}),t.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Assigned: ",$(e)]})]}),t.jsx("span",{className:"text-xs px-2 py-1 rounded-full font-medium bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300 ml-2",children:V(e)})]})})},e.id))),C.length>4&&t.jsxs("div",{className:"text-center py-2 text-sm text-gray-500 dark:text-gray-400",children:["Showing 4 of ",C.length," jobs"]})]})})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsx(g,{title:"Invoicing",viewAllLink:"/dashboard/jobs/invoicing",titleColor:"text-gray-900 dark:text-white",className:"min-h-[400px]",phaseColor:v.Invoicing||"#10B981",children:t.jsx("div",{className:"space-y-4 max-h-[300px] overflow-y-auto",children:0===P.length?t.jsx("div",{className:"text-center py-8 text-gray-500",children:"No jobs in invoicing"}):t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase",children:[t.jsx("th",{className:"pb-2",children:"ID"}),t.jsx("th",{className:"pb-2",children:"Property"}),t.jsx("th",{className:"pb-2",children:"Amount"}),t.jsx("th",{className:"pb-2",children:"Sent"}),t.jsx("th",{className:"pb-2",children:"Paid"})]})}),t.jsx("tbody",{className:"text-gray-700 dark:text-gray-300 text-sm",children:P.slice(0,8).map((e=>t.jsxs("tr",{className:"cursor-pointer hover:bg-gray-50/50 dark:hover:bg-[#1E293B]/30 transition-colors",children:[t.jsx("td",{className:"py-2",children:t.jsx(r,{to:`/dashboard/jobs/${e.id}`,className:"block",children:`WO-${String(e.work_order_num).padStart(6,"0")}`})}),t.jsx("td",{className:"py-2",children:t.jsx(r,{to:`/dashboard/jobs/${e.id}`,className:"block",children:S(e)})}),t.jsx("td",{className:"py-2",children:t.jsx(r,{to:`/dashboard/jobs/${e.id}`,className:"block",children:t.jsx("span",{className:"font-semibold text-emerald-600 dark:text-emerald-400",children:e.total_billing_amount?`$${e.total_billing_amount.toFixed(2)}`:"$0.00"})})}),t.jsx("td",{className:"py-2",children:t.jsx("div",{className:"flex items-center justify-center",children:t.jsx("svg",{className:"h-4 w-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})}),t.jsx("td",{className:"py-2",children:t.jsx("div",{className:"flex items-center justify-center",children:t.jsx("svg",{className:"h-4 w-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})})]},e.id)))})]})})}),t.jsx(g,{title:"Completed",viewAllLink:"/dashboard/jobs/completed",titleColor:"text-gray-900 dark:text-white",className:"min-h-[400px]",phaseColor:v.Completed||"#EF4444",children:t.jsx("div",{className:"space-y-4 max-h-[300px] overflow-y-auto",children:0===q.length?t.jsx("div",{className:"text-center py-8 text-gray-500",children:"No completed jobs"}):t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase",children:[t.jsx("th",{className:"pb-2",children:"ID"}),t.jsx("th",{className:"pb-2",children:"Property"}),t.jsx("th",{className:"pb-2",children:"Date Modified"})]})}),t.jsx("tbody",{className:"text-gray-700 dark:text-gray-300 text-sm",children:q.map((e=>t.jsxs("tr",{className:"cursor-pointer hover:bg-gray-50/50 dark:hover:bg-[#1E293B]/30 transition-colors",children:[t.jsx("td",{className:"py-2",children:t.jsx(r,{to:`/dashboard/jobs/${e.id}`,className:"block",children:`WO-${String(e.work_order_num).padStart(6,"0")}`})}),t.jsx("td",{className:"py-2",children:t.jsx(r,{to:`/dashboard/jobs/${e.id}`,className:"block",children:e.property?.property_name||"Unknown Property"})}),t.jsx("td",{className:"py-2",children:t.jsx(r,{to:`/dashboard/jobs/${e.id}`,className:"block",children:new Date(e.updated_at||e.created_at).toLocaleDateString()})})]},e.id)))})]})})}),t.jsx(g,{title:"Recent Activity",viewAllLink:"/dashboard/activity",titleColor:"text-gray-900 dark:text-white",className:"min-h-[400px]",children:t.jsx("div",{className:"space-y-4 max-h-[300px] overflow-y-auto",children:0===d.length?t.jsx("div",{className:"text-center py-8 text-gray-500",children:"No recent activity"}):d.map((e=>t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("div",{className:"mt-1",children:t.jsx(b,{className:"h-5 w-5 text-blue-500"})}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("p",{className:"text-sm text-gray-900 dark:text-white",children:["Job status updated",t.jsx("span",{className:"inline-flex items-center mx-1",children:t.jsx(j,{className:"h-4 w-4 text-gray-400"})}),t.jsx("span",{style:{color:e.to_phase_color},children:e.to_phase_label})]}),t.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:I(e.changed_at)})]}),t.jsxs("div",{className:"mt-1 flex items-center text-xs text-gray-500 dark:text-gray-400",children:[t.jsx(h,{className:"h-3 w-3 mr-1"}),T(e.job_work_order_num),t.jsx("span",{className:"mx-1",children:"â€¢"}),e.property_name," - Unit ",e.job_unit_number,t.jsx(j,{className:"h-3 w-3 mx-1"}),t.jsx(r,{to:`/dashboard/jobs/${e.job_id}`,className:"text-blue-500 hover:text-blue-400",children:"View Job"})]})]})]},e.id)))})})]}),t.jsx(f,{open:e,onClose:()=>l(!1),jobs:C})]})}const k=a.lazy((()=>e((()=>import("./Jobs-BDmeFfNv.js")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])).then((e=>({default:e.Jobs}))))),v=a.lazy((()=>e((()=>import("./JobRequests-DqEGPHlU.js")),__vite__mapDeps([10,1,2,3,4,5,6,7,8])).then((e=>({default:e.JobRequests}))))),w=a.lazy((()=>e((()=>import("./WorkOrders-CVA0KZMb.js")),__vite__mapDeps([11,1,2,3,4,5,6,7,8])).then((e=>({default:e.WorkOrders}))))),A=a.lazy((()=>e((()=>import("./Invoicing-C8KmSYwR.js")),__vite__mapDeps([12,1,2,3,4,5,6,7,8])).then((e=>({default:e.Invoicing}))))),E=a.lazy((()=>e((()=>import("./Completed-D_RVVo0L.js")),__vite__mapDeps([13,1,2,3,4,5,6,7,8])).then((e=>({default:e.Completed}))))),P=a.lazy((()=>e((()=>import("./CancelledJobs-BjLmXNcK.js")),__vite__mapDeps([14,1,2,3,4,5,6,7,8])).then((e=>({default:e.CancelledJobs}))))),D=a.lazy((()=>e((()=>import("./Archives-CAStDcZD.js")),__vite__mapDeps([15,1,2,3,4,5,6,7,8])).then((e=>({default:e.Archives}))))),O=a.lazy((()=>e((()=>import("./JobDetails-Bg3YzdwA.js")),__vite__mapDeps([16,1,2,3,4,17,6,18,19,8,7,20,21,22,23])).then((e=>({default:e.JobDetails}))))),T=a.lazy((()=>e((()=>import("./Properties-C_fBInSo.js")),__vite__mapDeps([24,1,2,3,4,25,9,8])).then((e=>({default:e.Properties}))))),I=a.lazy((()=>e((()=>import("./PropertyDetails-CnL1jjbn.js")),__vite__mapDeps([26,1,2,3,4,20,21,22,9,25,5,6,7,8])).then((e=>({default:e.PropertyDetails}))))),R=a.lazy((()=>e((()=>import("./PropertyForm-B-a_C1fk.js")),__vite__mapDeps([27,1,2,3,4,28,21,22,8])).then((e=>({default:e.PropertyForm}))))),C=a.lazy((()=>e((()=>import("./PropertyEditForm-knXh7yDm.js")),__vite__mapDeps([29,1,2,3,4,28,21,22,8])).then((e=>({default:e.PropertyEditForm}))))),L=a.lazy((()=>e((()=>import("./PropertyGroups-BTYXn1GY.js")),__vite__mapDeps([30,1,2,3,4,18,8])).then((e=>({default:e.PropertyGroups}))))),S=a.lazy((()=>e((()=>import("./PropertyGroupDetails-DBANIIEh.js")),__vite__mapDeps([31,1,2,3,4,8])).then((e=>({default:e.PropertyGroupDetails}))))),$=a.lazy((()=>e((()=>import("./PropertyGroupForm-6MjDuXq5.js")),__vite__mapDeps([32,1,2,3,4,8])).then((e=>({default:e.PropertyGroupForm}))))),V=a.lazy((()=>e((()=>import("./PropertyGroupArchives-DNEZ-6TX.js")),__vite__mapDeps([33,1,2,3,4,18,8])).then((e=>({default:e.PropertyGroupArchives}))))),q=a.lazy((()=>e((()=>import("./PropertyArchives-Dt1DH1PE.js")),__vite__mapDeps([34,1,2,3,4,8])).then((e=>({default:e.PropertyArchives}))))),z=a.lazy((()=>e((()=>import("./FileManager-Cbu_yuWG.js")),__vite__mapDeps([35,1,2,3,4,8,36])).then((e=>({default:e.FileManager}))))),W=a.lazy((()=>e((()=>import("./FileUpload-BL7SCv_p.js")),__vite__mapDeps([37,1,2,3,4,8])).then((e=>({default:e.FileUpload}))))),J=a.lazy((()=>e((()=>import("./Calendar-CMOg8zoZ.js")),__vite__mapDeps([38,1,2,3,4,9,6,8])).then((e=>({default:e.Calendar}))))),F=a.lazy((()=>e((()=>import("./Activity-BxjqOuoJ.js")),__vite__mapDeps([39,1,2,3,4,6,8])).then((e=>({default:e.Activity}))))),U=a.lazy((()=>e((()=>import("./Users-HgoTATKV.js")),__vite__mapDeps([40,1,2,3,4,8])).then((e=>({default:e.Users}))))),B=a.lazy((()=>e((()=>import("./AppSettings-DA1FAGsZ.js")),__vite__mapDeps([41,1,2,3,4,8])).then((e=>({default:e.AppSettings}))))),M=a.lazy((()=>e((()=>import("./UserProfile-BkOF2MHu.js")),__vite__mapDeps([42,1,2,3,4,8])).then((e=>({default:e.UserProfile}))))),G=a.lazy((()=>e((()=>import("./SubScheduler-Om-KhleU.js")),__vite__mapDeps([43,1,2,3,4,17,6,8])))),X=a.lazy((()=>e((()=>import("./JobRequestForm-dhntaJAk.js")),__vite__mapDeps([44,1,2,3,4,17,6,8])).then((e=>({default:e.JobRequestForm}))))),H=a.lazy((()=>e((()=>import("./JobEditForm-BqdG3JOi.js")),__vite__mapDeps([45,1,2,3,4,17,6,8])).then((e=>({default:e.JobEditForm}))))),Y=a.lazy((()=>e((()=>import("./WorkOrderForm-DW5N3ujR.js")),__vite__mapDeps([46,1,2,3,4])).then((e=>({default:e.WorkOrderForm}))))),K=a.lazy((()=>e((()=>import("./WorkOrderEditForm-DDJN3MXb.js")),__vite__mapDeps([47,1,2,3,4])).then((e=>({default:e.WorkOrderEditForm}))))),Q=a.lazy((()=>e((()=>import("./BillingDetailsForm-VptSc7No.js")),__vite__mapDeps([48,1,2,3,4,9,8])).then((e=>({default:e.BillingDetailsForm}))))),Z=a.lazy((()=>e((()=>import("./NewWorkOrder-x0yinFaI.js")),__vite__mapDeps([49,1,2,3,4,17,6,23,8]))));a.lazy((()=>e((()=>import("./TempWorkOrderForm-C8Jkvy9Q.js")),__vite__mapDeps([50,1,2,3,4]))));const ee=a.lazy((()=>e((()=>import("./WorkingOrdersBilling-DjFJWDmY.js")),__vite__mapDeps([51,1,2,3,4])).then((e=>({default:e.WorkingOrdersBilling}))))),te=()=>t.jsx("div",{className:"flex items-center justify-center h-full",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});function se(){return t.jsx("main",{className:"flex-1 overflow-auto",children:t.jsx(a.Suspense,{fallback:t.jsx(te,{}),children:t.jsxs(l,{children:[t.jsx(n,{index:!0,element:t.jsx(N,{})}),t.jsxs(n,{path:"jobs",children:[t.jsx(n,{index:!0,element:t.jsx(k,{})}),t.jsx(n,{path:"requests",element:t.jsx(v,{})}),t.jsx(n,{path:"work-orders",element:t.jsx(w,{})}),t.jsx(n,{path:"invoicing",element:t.jsx(A,{})}),t.jsx(n,{path:"completed",element:t.jsx(E,{})}),t.jsx(n,{path:"cancelled",element:t.jsx(P,{})}),t.jsx(n,{path:"archives",element:t.jsx(D,{})}),t.jsx(n,{path:":jobId",element:t.jsx(O,{})}),t.jsx(n,{path:":jobId/edit",element:t.jsx(H,{})}),t.jsx(n,{path:":jobId/work-order",element:t.jsx(Y,{})}),t.jsx(n,{path:":jobId/work-order/edit",element:t.jsx(K,{})}),t.jsx(n,{path:":jobId/billing",element:t.jsx(ee,{})}),t.jsx(n,{path:":jobId/new-work-order",element:t.jsx(Z,{})}),t.jsx(n,{path:"new",element:t.jsx(X,{})})]}),t.jsxs(n,{path:"properties",children:[t.jsx(n,{index:!0,element:t.jsx(T,{})}),t.jsx(n,{path:"new",element:t.jsx(R,{})}),t.jsx(n,{path:"archives",element:t.jsx(q,{})}),t.jsxs(n,{path:":propertyId",children:[t.jsx(n,{index:!0,element:t.jsx(I,{})}),t.jsx(n,{path:"edit",element:t.jsx(C,{})}),t.jsx(n,{path:"billing",element:t.jsx(Q,{})})]})]}),t.jsxs(n,{path:"property-groups",children:[t.jsx(n,{index:!0,element:t.jsx(L,{})}),t.jsx(n,{path:"new",element:t.jsx($,{})}),t.jsx(n,{path:"archives",element:t.jsx(V,{})}),t.jsx(n,{path:":groupId",element:t.jsx(S,{})})]}),t.jsxs(n,{path:"files",children:[t.jsx(n,{index:!0,element:t.jsx(z,{})}),t.jsx(n,{path:"upload",element:t.jsx(W,{})})]}),t.jsx(n,{path:"calendar",element:t.jsx(J,{})}),t.jsx(n,{path:"activity",element:t.jsx(F,{})}),t.jsx(n,{path:"users",element:t.jsx(U,{})}),t.jsx(n,{path:"settings",element:t.jsx(B,{})}),t.jsx(n,{path:"profile",element:t.jsx(M,{})}),t.jsx(n,{path:"sub-scheduler",element:t.jsx(G,{})}),t.jsx(n,{path:"job-request",element:t.jsx(X,{})})]})})})}export{se as Dashboard,se as default};
